/*! specstatic/0.0.1, 2013-11-05
    Robin Berjon <robin@berjon.com>, http://berjon.com/, @robinberjon */
!function(){function a(a,b,c){var d=[];for("string"==typeof b&&(b=[b]);a.parentNode&&1===a.parentNode.nodeType;){if(b.indexOf(a.parentNode.tagName.toLowerCase())>-1){if(c)return a.parentNode;d.push(a.parentNode)}a=a.parentNode}return c?null:d}function b(a,b,c){var d=[];for(a=a.previousElementSibling?a.previousElementSibling:a.parentNode,"string"==typeof b&&(b=[b]);a&&1===a.nodeType;){if(b.indexOf(a.parentNode.tagName.toLowerCase())>-1){if(c)return a;d.push(a)}a=a.previousElementSibling?a.previousElementSibling:a.parentNode}return c?null:d}function c(a){if(a.hasAttribute("id"))return a.getAttribute("id");for(;document.getElementById("specstatic-"+i);)i++;return a.setAttribute("id","specstatic-"+i),"specstatic-"+i}function d(a){if(a.content&&a.target){var b=document.createElement("div"),c=a.position;return b.classList.add("specstatic-tooltip"),b.classList.add("removeOnSave"),a.hover&&b.classList.add("specstatic-menu"),b.innerHTML=a.content,"append"===c&&(b.classList.add("specstatic-append"),a.target.appendChild(b)),b}}function e(a){a.parentNode.removeChild(a)}function f(){var f=document.currentScript?document.currentScript.src:null;if(!f)for(var i=document.querySelectorAll("script[src]"),j=0,k=i.length;k>j;j++){var l=i[j],m=l.getAttribute("src");if(/specstatic(\.min)?\.js$/.test(m)){f=m;break}}f=f.replace(/\.js$/,".css");var n=document.createElement("link");n.setAttribute("href",f),n.setAttribute("rel","stylesheet"),document.head.appendChild(n);for(var o=!!document.querySelector("section"),p=document.querySelectorAll("[id]"),j=0,k=p.length;k>j;j++){var q=p[j],r=q.tagName.toLowerCase();/^h[2-6]$/.test(r)?(q.addEventListener("mouseenter",function(a){var b=a.target.getAttribute("id");g=d({target:a.target,position:"append",content:"<a href='#"+b+"' class='specstatic-anchorlink'>ยง</a>"})}),q.addEventListener("mouseleave",function(){e(g)})):"dfn"===r&&q.addEventListener("click",function(f){if(f.stopPropagation(),h)return e(h),h=null,void 0;var g;if(f.target.specstaticContent)g=f.target.specstaticContent;else{var i=f.target.getAttribute("id"),g="<p><a href='#"+i+"'>#"+i+"</a></p>\n",j=document.querySelectorAll("a[href='#"+i+"']");if(j.length){for(var k={},l=0,m=j.length;m>l;l++){var n,p,q=j[l],r=c(q);if(o){var s=a(q,"section",!0);p=s.firstElementChild,n=c(s)}else p=b(q,"h2 h3 h4 h5 h6".split(" "),!0),n=c(p);k[n]?k[n].refs.push(r):/^h[2-6]$/i.test(p.tagName)&&(k[n]={title:p.innerHTML.replace(/<(\/)?a\b/gi,"<$1span"),id:n,refs:[r]})}g+="<p>Referenced in:</p>\n<ul>\n";for(var t in k)if(k.hasOwnProperty(t)){for(var s=k[t],u=[],v=0,w=s.refs.length;w>v;v++)u.push("<a href='#"+s.refs[v]+"'>"+(v+1)+"</a>");g+="<li><a href='#"+s.id+"'>"+s.title+"</a> <span class='specstatic-refs'>"+u.join(", ")+"</span></li>"}g+="</ul>\n"}else g+="<p>No references.</p>\n";f.target.specstaticContent=g}h=d({target:f.target,position:"append",content:g,hover:!0})})}document.body.addEventListener("click",function(){h&&e(h),h=null})}if("querySelector"in document){var g,h,i=1;if("respecEvents"in window){if(document.respecDone)return f();respecEvents.sub("end-all",f)}else document.addEventListener("DOMContentLoaded",f)}}();